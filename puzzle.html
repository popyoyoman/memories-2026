<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›æ†¶æ‹¼åœ–å°éŠæˆ² ğŸ§©</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@700&family=Noto+Sans+TC:wght@300;400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --bg-color: #faf8f6;
            --text-color: #4a4a4a;
            --accent-color: #d8b4a0;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Noto Sans TC', sans-serif;
            margin: 0; padding: 0;
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh;
        }

        header {
            text-align: center;
            padding: 40px 20px;
        }

        h1 {
            font-family: 'Noto Serif TC', serif;
            font-size: 2.2rem;
            margin: 0;
            color: #5d5d5d;
        }

        .stats {
            margin: 10px 0;
            font-size: 1rem;
            color: #888;
        }

        #game-board-container {
            position: relative;
            width: 90vw;
            max-width: 450px;
            margin: 10px auto;
        }

        #game-container {
            width: 100%;
            aspect-ratio: 1/1;
            display: grid;
            gap: 4px;
            background: #e0e0e0;
            border: 8px solid white;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            border-radius: 12px;
            overflow: hidden;
        }

        .tile {
            width: 100%;
            height: 100%;
            background-size: 0 0; /* å‹•æ…‹è¨­å®š */
            cursor: pointer;
            transition: transform 0.15s ease-out, filter 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .empty {
            background: #f5f5f5 !important;
            cursor: default;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
        }

        /* æç¤ºåœ– */
        #hint-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            border-radius: 4px;
            z-index: 10;
        }
        #hint-overlay.show { opacity: 0.6; }

        .controls {
            margin-top: 25px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            padding: 0 20px;
        }

        .diff-select {
            margin-bottom: 15px;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            background: white;
            color: var(--text-color);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.2s;
            border: 1px solid #eee;
        }

        button:hover {
            background: var(--accent-color);
            color: white;
            transform: translateY(-2px);
        }

        button.active {
            background: #5d5d5d;
            color: white;
        }

        #victory-msg {
            display: none;
            margin-top: 15px;
            color: #d4a373;
            font-weight: 700;
            font-size: 1.3rem;
            text-align: center;
        }

        .back-link {
            margin: 40px 0;
            color: #aaa;
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.2s;
        }
        .back-link:hover { color: var(--accent-color); }

        @media (max-width: 500px) {
            h1 { font-size: 1.8rem; }
            button { padding: 8px 15px; font-size: 0.85rem; }
        }
    </style>
</head>
<body>

    <header>
        <h1>ğŸ§© æ‹¼å‡ºçè²´å›æ†¶</h1>
        <div class="stats">æ­¥æ•¸: <span id="moves">0</span> | é›£åº¦: <span id="diff-text">ç°¡å–® (3x3)</span></div>
    </header>

    <div id="game-board-container">
        <div id="game-container"></div>
        <div id="hint-overlay"></div>
    </div>

    <div id="victory-msg">ğŸ‰ å®Œç¾çš„æ‹¼åœ–ï¼å¤ªæ£’äº†ï¼ ğŸ‰</div>

    <div class="controls">
        <div class="diff-select">
            <button onclick="setDifficulty(3)" id="btn-3" class="active">3x3</button>
            <button onclick="setDifficulty(4)" id="btn-4">4x4</button>
            <button onclick="setDifficulty(5)" id="btn-5">5x5</button>
        </div>
        <button onclick="shuffleGame()">é‡æ–°æ´—ç‰Œ</button>
        <button onmousedown="showHint(true)" onmouseup="showHint(false)" ontouchstart="showHint(true)" ontouchend="showHint(false)">æŒ‰ä½çœ‹æç¤º</button>
        <button onclick="nextPhoto()">æ›ä¸€å¼µç…§ç‰‡</button>
    </div>

    <a href="index.html" class="back-link">â† è¿”å›çè²´å›æ†¶éŒ„</a>

    <script>
                const allPhotos = ["mem_000_walking.jpg", "mem_000_twins.jpg", "mem_000_grandpa.jpg", "mem_000_birthday.jpg", "mem_001.jpg", "mem_002.jpg", "mem_003.jpg", "mem_004.jpg", "mem_005.jpg", "mem_006.jpg", "mem_007.jpg", "mem_008.jpg", "mem_009.jpg", "mem_010.jpg", "mem_011.jpg", "mem_012.jpg", "mem_013.jpg", "mem_014.jpg", "mem_015.jpg", "mem_016.jpg", "mem_017.jpg", "mem_018.jpg", "mem_019.jpg", "mem_020.jpg", "mem_021.jpg", "mem_022.jpg", "mem_023.jpg", "mem_024.jpg", "mem_025.jpg", "mem_026.jpg", "mem_027.jpg", "mem_028.jpg", "mem_029.jpg", "mem_030.jpg", "mem_031.jpg", "mem_032.jpg", "mem_033.jpg", "mem_034.jpg", "mem_035.jpg", "mem_036.jpg", "mem_037.jpg", "mem_038.jpg", "mem_039.jpg", "mem_040.jpg", "mem_041.jpg", "mem_042.jpg", "mem_043.jpg", "mem_044.jpg", "mem_045.jpg", "mem_046.jpg", "mem_047.jpg", "mem_048.jpg", "mem_049.jpg", "mem_050.jpg", "mem_051.jpg", "mem_052.jpg", "mem_053.jpg", "mem_054.jpg", "mem_055.jpg", "mem_056.jpg", "mem_057.jpg", "mem_058.jpg", "mem_059.jpg", "mem_060.jpg", "mem_061.jpg", "mem_062.jpg", "mem_063.jpg", "mem_064.jpg", "mem_065.jpg", "mem_066.jpg", "mem_067.jpg", "mem_068.jpg", "mem_069.jpg", "mem_070.jpg", "mem_071.jpg", "mem_072.jpg", "mem_073.jpg", "mem_074.jpg", "mem_075.jpg", "mem_076.jpg", "mem_077.jpg", "mem_078.jpg", "mem_079.jpg", "mem_080.jpg", "mem_081.jpg", "mem_082.jpg", "mem_083.jpg", "mem_084.jpg", "mem_085.jpg", "mem_086.jpg", "mem_087.jpg", "mem_088.jpg", "mem_089.jpg", "mem_090.jpg", "mem_091.jpg", "mem_092.jpg", "mem_093.jpg", "mem_094.jpg", "mem_095.jpg", "mem_096.jpg", "mem_097.jpg", "mem_098.jpg", "mem_099.jpg", "mem_100.jpg", "mem_101.jpg", "mem_102.jpg", "mem_103.jpg", "mem_104.jpg", "mem_105.jpg", "mem_106.jpg", "mem_107.jpg", "mem_108.jpg", "mem_109.jpg", "mem_110.jpg", "mem_111.jpg", "mem_112.jpg", "mem_113.jpg", "mem_114.jpg", "mem_115.jpg", "mem_116.jpg", "mem_117.jpg", "mem_118.jpg", "mem_119.jpg", "mem_120.jpg", "mem_121.jpg", "mem_122.jpg", "mem_123.jpg", "mem_124.jpg", "mem_125.jpg", "mem_126.jpg", "mem_127.jpg", "mem_128.jpg", "mem_129.jpg", "mem_130.jpg", "mem_131.jpg", "mem_132.jpg", "mem_133.jpg", "mem_134.jpg", "mem_135.jpg", "mem_136.jpg", "mem_137.jpg", "mem_138.jpg", "mem_139.jpg", "mem_140.jpg", "mem_141.jpg", "mem_142.jpg", "mem_143.jpg", "mem_144.jpg", "mem_145.jpg", "mem_146.jpg", "mem_147.jpg", "mem_148.jpg", "mem_149.jpg", "mem_150.jpg", "mem_151.jpg", "mem_152.jpg", "mem_153.jpg", "mem_154.jpg", "mem_155.jpg", "mem_156.jpg", "mem_157.jpg", "mem_158.jpg", "mem_159.jpg", "mem_160.jpg", "mem_161.jpg", "mem_162.jpg", "mem_163.jpg", "mem_164.jpg", "mem_165.jpg", "mem_166.jpg", "mem_167.jpg", "mem_168.jpg", "mem_169.jpg", "mem_170.jpg", "mem_171.jpg", "mem_172.jpg", "mem_173.jpg", "mem_174.jpg", "mem_175.jpg", "mem_176.jpg", "mem_177.jpg", "mem_178.jpg", "mem_179.jpg", "mem_180.jpg", "mem_181.jpg", "mem_182.jpg", "mem_183.jpg", "mem_184.jpg", "mem_185.jpg", "mem_186.jpg", "mem_187.jpg", "mem_188.jpg", "mem_189.jpg", "mem_190.jpg", "mem_191.jpg", "mem_192.jpg", "mem_193.jpg", "mem_194.jpg", "mem_195.jpg", "mem_196.jpg", "mem_197.jpg", "mem_198.jpg", "mem_199.jpg", "mem_200.jpg", "mem_201.jpg", "mem_202.jpg", "mem_203.jpg", "mem_204.jpg", "mem_205.jpg", "mem_206.jpg", "mem_207.jpg", "mem_208.jpg", "mem_209.jpg", "mem_210.jpg", "mem_211.jpg", "mem_212.jpg", "mem_213.jpg", "mem_214.jpg", "mem_215.jpg", "mem_216.jpg", "mem_217.jpg", "mem_218.jpg", "mem_219.jpg", "mem_220.jpg", "mem_221.jpg", "mem_222.jpg", "mem_223.jpg", "mem_224.jpg", "mem_225.jpg", "mem_226.jpg", "mem_227.jpg", "mem_228.jpg", "mem_229.jpg", "mem_230.jpg", "mem_231.jpg", "mem_232.jpg", "mem_233.jpg", "mem_234.jpg", "mem_235.jpg", "mem_236.jpg", "mem_237.jpg", "mem_238.jpg", "mem_239.jpg", "mem_240.jpg", "mem_241.jpg", "mem_242.jpg", "mem_243.jpg", "mem_244.jpg", "mem_245.jpg", "mem_246.jpg", "mem_247.jpg", "mem_248.jpg", "mem_249.jpg", "mem_250.jpg", "mem_251.jpg", "mem_252.jpg", "mem_253.jpg", "mem_254.jpg", "mem_255.jpg", "mem_256.jpg", "mem_257.jpg", "mem_258.jpg", "mem_259.jpg", "mem_260.jpg", "mem_261.jpg", "mem_262.jpg", "mem_263.jpg", "mem_264.jpg", "mem_265.jpg", "mem_266.jpg", "mem_267.jpg", "mem_268.jpg", "mem_269.jpg", "mem_270.jpg", "mem_271.jpg", "mem_272.jpg", "mem_273.jpg", "mem_274.jpg", "mem_275.jpg", "mem_276.jpg", "mem_277.jpg", "mem_278.jpg", "mem_279.jpg", "mem_280.jpg", "mem_281.jpg", "mem_282.jpg", "mem_283.jpg", "mem_284.jpg", "mem_285.jpg", "mem_286.jpg", "mem_287.jpg", "mem_288.jpg", "mem_289.jpg", "mem_290.jpg", "mem_291.jpg", "mem_292.jpg", "mem_293.jpg", "mem_294.jpg", "mem_295.jpg", "mem_296.jpg", "mem_297.jpg", "mem_298.jpg", "mem_299.jpg", "mem_300.jpg", "mem_301.jpg", "mem_302.jpg", "mem_303.jpg", "mem_304.jpg", "mem_305.jpg", "mem_306.jpg", "mem_307.jpg", "mem_308.jpg", "mem_309.jpg", "mem_310.jpg", "mem_311.jpg", "mem_312.jpg", "mem_313.jpg", "mem_314.jpg", "mem_315.jpg", "mem_316.jpg", "mem_317.jpg", "mem_318.jpg", "mem_319.jpg", "mem_320.jpg", "mem_321.jpg", "mem_322.jpg", "mem_323.jpg", "mem_324.jpg", "mem_325.jpg", "mem_326.jpg", "mem_327.jpg", "mem_328.jpg", "mem_329.jpg", "mem_330.jpg", "mem_331.jpg", "mem_332.jpg", "mem_333.jpg", "mem_334.jpg", "mem_335.jpg", "mem_336.jpg", "mem_337.jpg", "mem_338.jpg", "mem_339.jpg", "mem_340.jpg", "mem_341.jpg", "mem_342.jpg", "mem_343.jpg", "mem_344.jpg", "mem_345.jpg", "mem_346.jpg", "mem_347.jpg", "mem_348.jpg", "mem_349.jpg", "mem_350.jpg", "mem_351.jpg", "mem_352.jpg", "mem_353.jpg", "mem_354.jpg", "mem_355.jpg", "mem_356.jpg", "mem_357.jpg", "mem_358.jpg", "mem_359.jpg", "mem_360.jpg", "mem_361.jpg", "mem_362.jpg", "mem_363.jpg", "mem_364.jpg", "mem_365.jpg", "mem_366.jpg", "mem_367.jpg", "mem_368.jpg", "mem_369.jpg", "mem_370.jpg", "mem_371.jpg", "mem_372.jpg", "mem_373.jpg", "mem_374.jpg", "mem_375.jpg", "mem_376.jpg", "mem_377.jpg", "mem_378.jpg", "mem_379.jpg", "mem_380.jpg", "mem_381.jpg", "mem_382.jpg", "mem_383.jpg", "mem_384.jpg", "mem_385.jpg", "mem_386.jpg", "mem_387.jpg", "mem_388.jpg", "mem_389.jpg", "mem_390.jpg", "mem_391.jpg", "mem_392.jpg", "mem_393.jpg", "mem_394.jpg", "mem_395.jpg", "mem_396.jpg", "mem_397.jpg", "mem_398.jpg", "mem_399.jpg", "mem_400.jpg", "mem_401.jpg", "mem_402.jpg", "mem_403.jpg", "mem_404.jpg", "mem_405.jpg", "mem_406.jpg", "mem_407.jpg", "mem_408.jpg", "mem_409.jpg", "mem_410.jpg", "mem_411.jpg", "mem_412.jpg", "mem_413.jpg", "mem_414.jpg", "mem_415.jpg", "mem_416.jpg", "mem_417.jpg", "mem_418.jpg", "mem_419.jpg", "mem_420.jpg", "mem_421.jpg", "mem_422.jpg", "mem_423.jpg", "mem_424.jpg", "mem_425.jpg", "mem_426.jpg", "mem_427.jpg", "mem_428.jpg", "mem_429.jpg", "mem_430.jpg", "mem_431.jpg", "mem_432.jpg", "mem_433.jpg", "mem_434.jpg", "mem_435.jpg", "mem_436.jpg", "mem_437.jpg", "mem_438.jpg", "mem_439.jpg", "mem_440.jpg", "mem_441.jpg", "mem_442.jpg", "mem_443.jpg", "mem_444.jpg", "mem_445.jpg", "mem_446.jpg", "mem_447.jpg", "mem_448.jpg", "mem_449.jpg", "mem_450.jpg", "mem_451.jpg", "mem_452.jpg", "mem_453.jpg", "mem_454.jpg", "mem_455.jpg", "mem_456.jpg", "mem_457.jpg", "mem_458.jpg", "mem_459.jpg", "mem_460.jpg", "mem_461.jpg", "mem_462.jpg", "mem_463.jpg", "mem_464.jpg", "mem_465.jpg", "mem_466.jpg", "mem_467.jpg", "mem_468.jpg", "mem_469.jpg", "mem_470.jpg", "mem_471.jpg", "mem_472.jpg", "mem_473.jpg", "mem_474.jpg", "mem_475.jpg", "mem_476.jpg", "mem_477.jpg", "mem_478.jpg", "mem_479.jpg", "mem_480.jpg", "mem_481.jpg", "mem_482.jpg", "mem_483.jpg", "mem_484.jpg", "mem_485.jpg", "mem_486.jpg", "mem_487.jpg", "mem_488.jpg", "mem_489.jpg", "mem_490.jpg", "mem_491.jpg", "mem_492.jpg", "mem_493.jpg", "mem_494.jpg", "mem_495.jpg", "mem_496.jpg", "mem_497.jpg", "mem_498.jpg", "mem_499.jpg", "mem_500.jpg", "mem_501.jpg", "mem_502.jpg", "mem_503.jpg", "mem_504.jpg", "mem_505.jpg", "mem_506.jpg", "mem_507.jpg", "mem_508.jpg", "mem_509.jpg", "mem_510.jpg", "mem_511.jpg", "mem_512.jpg", "mem_513.jpg", "mem_514.jpg", "mem_515.jpg", "mem_516.jpg", "mem_517.jpg", "mem_518.jpg", "mem_519.jpg", "mem_520.jpg", "mem_521.jpg", "mem_522.jpg", "mem_523.jpg", "mem_524.jpg", "mem_525.jpg", "mem_526.jpg", "mem_527.jpg", "mem_528.jpg", "mem_529.jpg", "mem_530.jpg", "mem_531.jpg", "mem_532.jpg", "mem_533.jpg", "mem_534.jpg", "mem_535.jpg", "mem_536.jpg", "mem_537.jpg", "mem_538.jpg", "mem_539.jpg", "mem_540.jpg", "mem_541.jpg", "mem_542.jpg", "mem_543.jpg", "mem_544.jpg", "mem_545.jpg", "mem_546.jpg", "mem_547.jpg", "mem_548.jpg", "mem_549.jpg", "mem_550.jpg", "mem_551.jpg", "mem_552.jpg", "mem_553.jpg", "mem_554.jpg", "mem_555.jpg", "mem_556.jpg", "mem_557.jpg", "mem_558.jpg", "mem_559.jpg", "mem_560.jpg", "mem_561.jpg", "mem_562.jpg", "mem_563.jpg", "mem_564.jpg", "mem_565.jpg", "mem_566.jpg", "mem_567.jpg", "mem_568.jpg", "mem_569.jpg", "mem_570.jpg", "mem_571.jpg", "mem_572.jpg", "mem_573.jpg", "mem_574.jpg", "mem_575.jpg", "mem_576.jpg", "mem_577.jpg", "mem_578.jpg", "mem_579.jpg", "mem_580.jpg", "mem_581.jpg", "mem_582.jpg", "mem_583.jpg", "mem_584.jpg", "mem_585.jpg", "mem_586.jpg", "mem_587.jpg", "mem_588.jpg", "mem_589.jpg", "mem_590.jpg", "mem_591.jpg", "mem_592.jpg", "mem_593.jpg", "mem_594.jpg", "mem_595.jpg", "mem_596.jpg", "mem_597.jpg", "mem_598.jpg", "mem_599.jpg", "mem_600.jpg", "mem_601.jpg", "mem_602.jpg", "mem_603.jpg", "mem_604.jpg", "mem_605.jpg", "mem_606.jpg", "mem_607.jpg", "mem_608.jpg", "mem_609.jpg", "mem_610.jpg", "mem_611.jpg", "mem_612.jpg", "mem_613.jpg", "mem_614.jpg", "mem_615.jpg", "mem_616.jpg", "mem_617.jpg", "mem_618.jpg", "mem_619.jpg", "mem_620.jpg", "mem_621.jpg", "mem_622.jpg", "mem_623.jpg", "mem_624.jpg", "mem_625.jpg", "mem_626.jpg", "mem_627.jpg", "mem_628.jpg", "mem_629.jpg", "mem_630.jpg", "mem_631.jpg", "mem_632.jpg", "mem_633.jpg", "mem_634.jpg", "mem_635.jpg", "mem_636.jpg", "mem_637.jpg", "mem_638.jpg", "mem_639.jpg", "mem_640.jpg", "mem_641.jpg", "mem_642.jpg", "mem_643.jpg", "mem_644.jpg", "mem_645.jpg", "mem_646.jpg", "mem_647.jpg", "mem_648.jpg", "mem_649.jpg", "mem_650.jpg", "mem_651.jpg", "mem_652.jpg", "mem_653.jpg", "mem_654.jpg", "mem_655.jpg", "mem_656.jpg", "mem_657.jpg", "mem_658.jpg", "mem_659.jpg", "mem_660.jpg", "mem_661.jpg", "mem_662.jpg", "mem_663.jpg", "mem_664.jpg", "mem_665.jpg", "mem_666.jpg", "mem_667.jpg"];

        let size = 3; // é è¨­ 3x3
        let tiles = [];
        let currentPhoto = "";
        let moveCount = 0;

        function setDifficulty(n) {
            size = n;
            document.querySelectorAll('.diff-select button').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-${n}`).classList.add('active');
            const labels = {3: "ç°¡å–® (3x3)", 4: "ä¸­ç­‰ (4x4)", 5: "å›°é›£ (5x5)"};
            document.getElementById('diff-text').innerText = labels[n];
            resetGame();
        }

        function resetGame() {
            moveCount = 0;
            document.getElementById('moves').innerText = "0";
            document.getElementById('victory-msg').style.display = 'none';
            tiles = Array.from({length: size * size}, (_, i) => i);
            initBoard();
            shuffleGame();
        }

        function initBoard() {
            const container = document.getElementById('game-container');
            container.style.gridTemplateColumns = `repeat(${size}, 1fr)`;
            container.style.gridTemplateRows = `repeat(${size}, 1fr)`;
            container.innerHTML = '';
            
            tiles.forEach((tileIndex, position) => {
                const tile = document.createElement('div');
                tile.className = 'tile';
                if (tileIndex === (size * size - 1)) {
                    tile.classList.add('empty');
                } else {
                    tile.style.backgroundImage = `url('images/${currentPhoto}')`;
                    tile.style.backgroundSize = `${size * 100}% ${size * 100}%`;
                    const row = Math.floor(tileIndex / size);
                    const col = tileIndex % size;
                    tile.style.backgroundPosition = `${(col / (size - 1)) * 100}% ${(row / (size - 1)) * 100}%`;
                    
                    // åŒæ™‚æ”¯æ´é»æ“Šèˆ‡è§¸æ§
                    tile.onclick = (e) => { e.preventDefault(); moveTile(position); };
                    tile.ontouchstart = (e) => { e.preventDefault(); moveTile(position); };
                }
                container.appendChild(tile);
            });
        }

        function moveTile(pos) {
            const emptyPos = tiles.indexOf(size * size - 1);
            const row = Math.floor(pos / size);
            const col = pos % size;
            const emptyRow = Math.floor(emptyPos / size);
            const emptyCol = emptyPos % size;

            const isAdjacent = (Math.abs(row - emptyRow) + Math.abs(col - emptyCol)) === 1;

            if (isAdjacent) {
                [tiles[pos], tiles[emptyPos]] = [tiles[emptyPos], tiles[pos]];
                moveCount++;
                document.getElementById('moves').innerText = moveCount;
                initBoard();
                checkWin();
            }
        }

        function shuffleGame() {
            // éš¨æ©Ÿç§»å‹•ä»¥ç¢ºä¿æœ‰è§£
            for (let i = 0; i < size * size * 30; i++) {
                const emptyPos = tiles.indexOf(size * size - 1);
                const neighbors = [];
                const r = Math.floor(emptyPos / size), c = emptyPos % size;
                if (r > 0) neighbors.push(emptyPos - size);
                if (r < size - 1) neighbors.push(emptyPos + size);
                if (c > 0) neighbors.push(emptyPos - 1);
                if (c < size - 1) neighbors.push(emptyPos + 1);
                const rand = neighbors[Math.floor(Math.random() * neighbors.length)];
                [tiles[emptyPos], tiles[rand]] = [tiles[rand], tiles[emptyPos]];
            }
            moveCount = 0;
            document.getElementById('moves').innerText = "0";
            document.getElementById('victory-msg').style.display = 'none';
            initBoard();
        }

        function nextPhoto() {
            currentPhoto = allPhotos[Math.floor(Math.random() * allPhotos.length)];
            document.getElementById('hint-overlay').style.backgroundImage = `url('images/${currentPhoto}')`;
            resetGame();
        }

        function showHint(show) {
            const overlay = document.getElementById('hint-overlay');
            if (show) overlay.classList.add('show');
            else overlay.classList.remove('show');
        }

        function checkWin() {
            if (tiles.every((t, i) => t === i)) {
                document.getElementById('victory-msg').style.display = 'block';
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
            }
        }

        // Start
        const urlParams = new URLSearchParams(window.location.search);
        const imgParam = urlParams.get('img');
        
        if (imgParam && allPhotos.includes(imgParam)) {
            currentPhoto = imgParam;
        } else {
            currentPhoto = allPhotos[Math.floor(Math.random() * allPhotos.length)];
        }
        
        document.getElementById('hint-overlay').style.backgroundImage = `url('images/${currentPhoto}')`;
        setDifficulty(3);
    </script>
</body>
</html>
